<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Ejemplo de Código</title>
</head>
<body>
  <!-- Título -->
  <h1>Mi primer fragmento de código</h1>

  <!-- Fragmento de código -->
  <pre><code>
      program E2
      implicit none
      real :: q(3),dp(3,3),dq(3),p(3),ya,xb,yb,error
      real :: suma
      integer :: i,j,k
      !Valores iniciales
      ya = 44
      xb = 100
      yb = 60
      error = 100
      !Deja la matriz de 3x3 rellena de ceros
      dp = 0.0

      do while(error>0.01)

         suma = 0.0
         !Definimos ecuaciones R
         p(1) = 40**2+ya**2-60**2
         p(2) = (xb-40)**2+(yb-ya)**2-100**2
         p(3) = (120-xb)**2 + (0-yb)**2-130**2
         !Definimos dp
         dp(1,1) = 2*ya
         dp(2,1) = -2*(yb-ya)
         dp(2,2) = 2*(xb-40)
         dp(2,3) = 2*(yb-ya)
         dp(3,2) = -2*(120-xb)
         dp(3,3) = 2*yb

         p = -p

         call gj(dp,p,3,dq)
         !Determino la norma de dq
         do i = 1,3,1
            suma = suma + dq(i)**2
         enddo
         error = sqrt(suma)

         ya = ya + dq(1)
         xb = xb + dq(2)
         yb = yb + dq(3)

         write(*,*) ya,xb,yb
      end do



      pause
      end program E2



C     Agregar subrutina GJ

      subroutine gj(A,b,dim,sol)
	implicit none
	integer :: dim, i ,j
	real :: m_amp(dim,dim+1), A(dim,dim), b(dim), sol(dim)

	m_amp(1:dim,1:dim) = A
	m_amp(:,dim+1) = b

	!!! evitar ceros en la diagonal

	do i = 1,dim
           do j = 1,dim
              m_amp(i,:) = m_amp(i,:) +m_amp(j,:)
        end do
        end do

	do i =1,dim
		m_amp(i,:) = m_amp(i,:)/m_amp(i,i)
		do j = 1,dim
			if (j /= i) then
		       m_amp(j,:) = m_amp(j,:) - m_amp(i,:) * m_amp(j,i)
			end if
		end do
	end do

	sol = m_amp(:,dim+1)
      end subroutine
  </code></pre>
</body>
</html>
